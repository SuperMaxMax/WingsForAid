from matplotlib import pyplot as plt
import numpy as np
from scipy import integrate

y_s_01 = [4.76346972e+00, 4.75648368e+00, 4.73554605e+00, 4.70071826e+00, 4.65210244e+00, 4.58984121e+00, 4.51411718e+00, 4.42515247e+00, 4.32320803e+00, 4.20858287e+00, 4.08161321e+00, 3.94267148e+00, 3.79216521e+00, 3.63053587e+00, 3.45825754e+00, 3.27583555e+00, 3.08380496e+00, 2.88272905e+00, 2.67319759e+00, 2.45582519e+00, 2.23124942e+00, 2.00012902e+00, 1.76314189e+00, 1.52098317e+00, 1.27436314e+00, 1.02400518e+00, 7.70643641e-01, 5.15021670e-01, 2.57889052e-01, 2.91678397e-16]
l_01 = [   0.,           53.60421032,  100.1402305,   139.85598761,  175.14683872 ,208.35821179, 241.27715089, 275.06702916, 310.42035712,  347.6892647 ,387.00818498, 428.3590757,  471.63055715, 516.63731809,  563.15078259 ,610.89691961, 659.57792068, 708.8578009,  758.3838469,   807.76117364 ,856.57897033, 904.36964863, 950.64482596, 994.82644906, 1036.30010275, 1074.28230424, 1107.90483602, 1135.87812805, 1156.61319215, 1166.38847489]

y_s_02 = [4.76346972e+00, 4.75648368e+00, 4.73554605e+00, 4.70071826e+00, 4.65210244e+00, 4.58984121e+00, 4.51411718e+00, 4.42515247e+00, 4.32320803e+00, 4.20858287e+00, 4.08161321e+00, 3.94267148e+00, 3.79216521e+00, 3.63053587e+00, 3.45825754e+00, 3.27583555e+00, 3.08380496e+00, 2.88272905e+00, 2.67319759e+00, 2.45582519e+00, 2.23124942e+00, 2.00012902e+00, 1.76314189e+00, 1.52098317e+00, 1.27436314e+00, 1.02400518e+00, 7.70643641e-01, 5.15021670e-01, 2.57889052e-01, 2.91678397e-16]
l_02 = [   0.,           66.05122886,  125.94657413,  178.60139979,  224.95259177,   266.52525491  ,304.88638379,  341.3678423,   377.0070833,   412.54914817,   448.50037751  ,485.16978168,  522.72245416,  561.20530069,  600.58440831,   640.75217537  ,681.55460093,  722.78414411,  764.20396443,  805.52814142,   846.44839014  ,886.59865645,  925.58966591,  962.94705596,  998.16124465 , 1030.56676096 ,1059.42029778, 1083.59316318, 1101.68330214, 1110.33357817]

y_s_03 = [4.763469717548333,4.756483678839986,4.735546053970155,4.700718256600087,4.652102442660222,4.589841210709242,4.514117183667927,4.425152473154669,4.323208027993823,4.208582868807848,4.081613210938289,3.9426714782682666,3.7921652108390496,3.6305358694648997,3.4582575408524394,3.275835547022658,3.083804963114358,2.8827290479165786,2.673197591733526,2.455825186427982,2.2312494227174846,2.000129020010897,1.763141894270883,1.520983169569587,1.2743631391699621,1.0240051821132474,0.7706436414236031,0.5150216701534963,0.25788905158775427,2.9167839712154564e-16]
l_03 = [0.0,73.3739669331326,141.1485677821,201.8043650912512,255.60109761005063,303.50099353540884,346.71838900679205,386.4400962311308,423.71211290101667,459.38574000932704,494.1236433704433,528.4106537809151,562.5874061958019,596.8674060454746,631.3695179010533,666.1257387012402,701.108394086444,736.2264571542815,771.3502172460769,806.2957647015554,840.8512583411863,874.746622442297,907.6862682474436,939.2943983413496,969.1611545453572,996.7345906534391,1021.3920645858468,1042.1634483448734,1057.8327630392196,1065.4180004874206]

y_s_04 = [4.763469717548333,4.756483678839986,4.735546053970155,4.700718256600087,4.652102442660222,4.589841210709242,4.514117183667927,4.425152473154669,4.323208027993823,4.208582868807848,4.081613210938289,3.9426714782682666,3.7921652108390496,3.6305358694648997,3.4582575408524394,3.275835547022658,3.083804963114358,2.8827290479165786,2.673197591733526,2.455825186427982,2.2312494227174846,2.000129020010897,1.763141894270883,1.520983169569587,1.2743631391699621,1.0240051821132474,0.7706436414236031,0.5150216701534963,0.25788905158775427,2.9167839712154564e-16]
l_04 = [0.0,78.50732417267119,151.77596856094002,218.08800840071225,277.32511327357764,330.0841757441667,377.298858665795,419.98361438501996,459.10959829870126,495.5299602242258,529.9612109980359,562.9745580827163,595.0134112941727,626.401116444619,657.3660583824224,688.0472213390078,718.5185243242129,748.7865196400579,778.8136664036045,808.506028504065,837.7380191225341,866.3268749216525,894.062858746818,920.6619329695097,945.8075967140988,969.0562950326364,989.9014428415663,1007.5297106679571,1020.91144796385,1027.4558873300753]

y_s_05 = [4.763469717548333,4.756483678839986,4.735546053970155,4.700718256600087,4.652102442660222,4.589841210709242,4.514117183667927,4.425152473154669,4.323208027993823,4.208582868807848,4.081613210938289,3.9426714782682666,3.7921652108390496,3.6305358694648997,3.4582575408524394,3.275835547022658,3.083804963114358,2.8827290479165786,2.673197591733526,2.455825186427982,2.2312494227174846,2.000129020010897,1.763141894270883,1.520983169569587,1.2743631391699621,1.0240051821132474,0.7706436414236031,0.5150216701534963,0.25788905158775427,2.9167839712154564e-16]
l_05 = [0.0,82.44183526019212,159.89460634391347,230.53128771133143,293.99439684811756,350.6294577615144,401.1563264090582,446.4366689028436,487.3511602802992,524.7177871305917,559.2604399935145,591.5889353293715,622.2051100400536,651.5034267338962,679.7891190591512,707.2812257222147,734.133126792024,760.4308490102663,786.2139129705677,811.4657188554617,836.1359439837215,860.1196469270183,883.2842829704178,905.4299983118714,926.3265007549849,945.63273961456,962.9527450527173,977.6274308785345,988.8128532277448,994.3255827847374]

y_s_06 = [4.763469717548333,4.756483678839986,4.735546053970155,4.700718256600087,4.652102442660222,4.589841210709242,4.514117183667927,4.425152473154669,4.323208027993823,4.208582868807848,4.081613210938289,3.9426714782682666,3.7921652108390496,3.6305358694648997,3.4582575408524394,3.275835547022658,3.083804963114358,2.8827290479165786,2.673197591733526,2.455825186427982,2.2312494227174846,2.000129020010897,1.763141894270883,1.520983169569587,1.2743631391699621,1.0240051821132474,0.7706436414236031,0.5150216701534963,0.25788905158775427,2.9167839712154564e-16]
l_06 = [0.0,85.62418191892432,166.44060691323963,240.5543220665063,307.4431443323994,367.2699363778453,420.58919587165474,468.1340723780567,510.6981118197919,549.0522281514988,583.9064728640241,615.8836453370157,645.5174021603403,673.2479424404058,699.434219628391,724.3549548124436,748.225211885694,771.1951936481986,793.3681254034079,814.7931623237924,835.4848521242911,855.4068773787235,874.4952987941991,892.6267677915206,909.6497792466646,925.3194425898976,939.3442807547306,951.2159288515471,960.2742100147784,964.757352844239]

y_s_07 = [4.763469717548333,4.756483678839986,4.735546053970155,4.700718256600087,4.652102442660222,4.589841210709242,4.514117183667927,4.425152473154669,4.323208027993823,4.208582868807848,4.081613210938289,3.9426714782682666,3.7921652108390496,3.6305358694648997,3.4582575408524394,3.275835547022658,3.083804963114358,2.8827290479165786,2.673197591733526,2.455825186427982,2.2312494227174846,2.000129020010897,1.763141894270883,1.520983169569587,1.2743631391699621,1.0240051821132474,0.7706436414236031,0.5150216701534963,0.25788905158775427,2.9167839712154564e-16]
l_07 = [0.0,88.29546574566025,171.9194734251657,248.93061853449143,318.6861216316595,381.2101677687521,436.92632382717017,486.460338747501,530.5269535264978,569.8479260548961,605.1100204534251,636.9351019424413,665.8725128983688,692.3915522618039,716.8887138011879,739.687358256167,761.0504423144629,781.1799727059754,800.2316507001684,818.3103359638158,835.4861499309999,851.7829642689942,867.1973670393465,881.675111895013,895.1361268797974,907.4251484176108,918.3486127606449,927.5444673385889,934.5330002770335,937.9859184678605]

y_s_08 = [4.763469717548333,4.756483678839986,4.735546053970155,4.700718256600087,4.652102442660222,4.589841210709242,4.514117183667927,4.425152473154669,4.323208027993823,4.208582868807848,4.081613210938289,3.9426714782682666,3.7921652108390496,3.6305358694648997,3.4582575408524394,3.275835547022658,3.083804963114358,2.8827290479165786,2.673197591733526,2.455825186427982,2.2312494227174846,2.000129020010897,1.763141894270883,1.520983169569587,1.2743631391699621,1.0240051821132474,0.7706436414236031,0.5150216701534963,0.25788905158775427,2.9167839712154564e-16]
l_08 = [0.0,90.59526369514606,176.62435616193955,256.11174074313334,328.3221854210822,393.17085681504165,450.97524780916586,502.27076087424615,547.7022409462317,587.944050273735,623.6558767913607,655.4510582405048,683.8846778017015,709.4440890270035,732.5519375888167,753.565133472679,772.7839184819734,790.4522477763566,806.7690474995493,821.8863706652107,835.9218190821113,848.9519411257869,861.0264773751412,872.1533670702045,882.3169133647881,891.4449897058397,899.4351518096545,906.0665837020398,911.0355677524425,913.45659095433]

y_s_09 = [4.763469717548333,4.756483678839986,4.735546053970155,4.700718256600087,4.652102442660222,4.589841210709242,4.514117183667927,4.425152473154669,4.323208027993823,4.208582868807848,4.081613210938289,3.9426714782682666,3.7921652108390496,3.6305358694648997,3.4582575408524394,3.275835547022658,3.083804963114358,2.8827290479165786,2.673197591733526,2.455825186427982,2.2312494227174846,2.000129020010897,1.763141894270883,1.520983169569587,1.2743631391699621,1.0240051821132474,0.7706436414236031,0.5150216701534963,0.25788905158775427,2.9167839712154564e-16]
l_09 = [0.0,92.61389954758415,180.74464632386253,262.3901361495301,336.7416854307493,403.6263292511418,463.273873692619,516.1429533840592,562.8167058948087,603.9252755841462,640.1002948268392,671.9425176909247,700.0065754514919,724.7904508474644,746.7348458323016,766.222001160293,783.5812798116679,799.0907661990067,812.9850483317899,825.4562446335502,836.6624857575508,846.7264094543708,855.7442888534572,863.7799050361848,870.8752945656272,877.03516654554,882.2413628954172,886.4087461025939,889.4041427939976,890.7916703672577]

y_s_1 = [4.763469717548333,4.756483678839986,4.735546053970155,4.700718256600087,4.652102442660222,4.589841210709242,4.514117183667927,4.425152473154669,4.323208027993823,4.208582868807848,4.081613210938289,3.9426714782682666,3.7921652108390496,3.6305358694648997,3.4582575408524394,3.275835547022658,3.083804963114358,2.8827290479165786,2.673197591733526,2.455825186427982,2.2312494227174846,2.000129020010897,1.763141894270883,1.520983169569587,1.2743631391699621,1.0240051821132474,0.7706436414236031,0.5150216701534963,0.25788905158775427,2.9167839712154564e-16]
l_1 = [0.0,94.41166788947024,184.4067450306123,267.9614911740928,344.20719354252395,412.8980014211903,474.1899597654638,528.4757717294855,576.2840121134411,618.2041581504617,654.8401986693731,686.778265797784,714.5686644086271,738.7149532468135,759.6700663695873,777.8354311895746,793.5632134451125,807.1594110366675,818.888097223279,828.975510135436,837.6143755899534,844.9676933200869,851.1723864894094,856.342329918781,860.5711290811585,863.934313864406,866.4912767905239,868.2866935218359,869.3517136488092,869.70469184132]

u=0     #x-position of the center
v=0    #y-position of the center
a=max(y_s_01)     #radius on the x-axis
b=(0.9*max(l_06)+1.1091*max(l_05))/2    #radius on the y-axis
#print(np.pi*a*b/4)
#print(-integrate.simps(l_03, y_s_03))

t = np.linspace(0, 0.5*np.pi, 100)

plt.figure(figsize=(10, 6))
plt.plot(u+a*np.cos(t), v+b*np.sin(t), label = "Elliptical Lift Distribution", color = 'k')
plt.plot(y_s_01, l_01, label = r"$\lambda$ = 0.1")
plt.plot(y_s_02, l_02, label = r"$\lambda$ = 0.2")
plt.plot(y_s_03, l_03, label = r"$\lambda$ = 0.3")
plt.plot(y_s_04, l_04, label = r"$\lambda$ = 0.4")
plt.plot(y_s_05, l_05, label = r"$\lambda$ = 0.5")
plt.plot(y_s_06, l_06, label = r"$\lambda$ = 0.6")
plt.plot(y_s_07, l_07, label = r"$\lambda$ = 0.7")
plt.plot(y_s_08, l_08, label = r"$\lambda$ = 0.8")
plt.plot(y_s_09, l_09, label = r"$\lambda$ = 0.9")
plt.plot(y_s_1, l_1, label = r"$\lambda$ = 1.0")
plt.xlabel("Wing Span [m]")
plt.ylabel("Sectional Lift [N/m]")
plt.legend()
plt.savefig('spanwise_lift_changing_taper.pdf')
plt.show()
=====================================================================
current option is: AR =  7.75 taper ratio =  0.8 indidence =  0.9852341903547764
Span_eff =  0.9923262827208658 CL_wing =  0.38050604379776876 CL required for cruis =  0.380505722301332 CD_i =  0.005992624275161098
0.9923262827208659

=====================================================================
current option is: AR =  7.75 taper ratio =  0.7 indidence =  0.9518558130081114
Span_eff =  0.9938013748589707 CL_wing =  0.380503853793402 CL required for cruis =  0.380505722301332 CD_i =  0.005983660588053073
0.9938013748589711

=====================================================================
current option is: AR =  7.75 taper ratio =  0.65 indidence =  0.9354402175917187
Span_eff =  0.9939869778685633 CL_wing =  0.3805039868428525 CL required for cruis =  0.380505722301332 CD_i =  0.005982547468057825
0.9939869778685634

=====================================================================
current option is: AR =  7.75 taper ratio =  0.6 indidence =  0.9193728317750671
Span_eff =  0.99371666238576 CL_wing =  0.38050592790373716 CL required for cruis =  0.380505722301332 CD_i =  0.005984235922942348
0.9937166623857603

=====================================================================
current option is: AR =  7.75 taper ratio =  0.5 indidence =  0.8888298754548696
Span_eff =  0.9914544353872745 CL_wing =  0.3805057996157076 CL required for cruis =  0.380505722301332 CD_i =  0.005997886263046358
0.9914544353872745

=====================================================================
current option is: AR =  7.75 taper ratio =  0.4 indidence =  0.8621172247318302
Span_eff =  0.9860752145215685 CL_wing =  0.38050628495179845 CL required for cruis =  0.380505722301332 CD_i =  0.00603062121506182
0.9860752145215683
